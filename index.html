<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="お買い物リスト v5">
    <meta name="robots" content="noindex">
    <title>お買い物リスト v5</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="app-container">
        <header>
            <h1>お買い物リスト v5</h1>
            <div class="header-buttons">
                <button id="backup-btn" class="btn-secondary">バックアップ</button>
                <button id="restore-btn" class="btn-secondary">復元</button>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="list">買い物リスト</button>
            <button class="tab-btn" data-tab="map">地図</button>
        </nav>

        <!-- 買い物リストタブ -->
        <div id="list-tab" class="tab-content active">
            <div class="add-item-section">
                <h2>新しいアイテムを追加</h2>
                <form id="add-item-form">
                    <div class="form-group">
                        <label for="space-no">スペースNo</label>
                        <input type="text" id="space-no" placeholder="例: て01a, A-23b" required>
                    </div>
                    <div class="form-group">
                        <label for="item-name">商品名</label>
                        <input type="text" id="item-name" placeholder="商品名を入力" required>
                    </div>
                    <div class="form-group">
                        <label for="item-price">価格</label>
                        <input type="number" id="item-price" placeholder="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="item-quantity">数量</label>
                        <input type="number" id="item-quantity" value="1" min="1">
                    </div>
                    <div class="form-group">
                        <label for="item-notes">備考</label>
                        <textarea id="item-notes" placeholder="備考を入力（任意）" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="item-image">サムネイル</label>
                        <input type="file" id="item-image" accept="image/*">
                        <div id="image-preview"></div>
                    </div>
                    <button type="submit" class="btn-primary">追加</button>
                </form>
            </div>

            <div class="shopping-list">
                <div class="list-header">
                    <h2>買い物リスト</h2>
                    <div class="list-controls">
                        <div class="sort-controls">
                            <label for="sort-option">並び順:</label>
                            <select id="sort-option" onchange="renderShoppingList()">
                                <option value="spaceNo">スペースNo順</option>
                                <option value="name">商品名順</option>
                                <option value="price">価格順</option>
                                <option value="created">追加順</option>
                            </select>
                        </div>
                        <div class="view-controls">
                            <button id="expand-all" class="btn-small">全て展開</button>
                            <button id="collapse-all" class="btn-small">全て折りたたみ</button>
                        </div>
                    </div>
                </div>
                <div class="list-stats">
                    <span>合計: <span id="total-amount">¥0</span></span>
                    <span>アイテム数: <span id="item-count">0</span></span>
                    <span>スペース数: <span id="space-count">0</span></span>
                </div>
                <div id="shopping-items"></div>
            </div>
        </div>

        <!-- 地図タブ -->
        <div id="map-tab" class="tab-content">
            <div class="map-controls">
                <input type="file" id="map-upload" accept="image/*,.svg">
                <button id="create-sample-map" class="btn-secondary">サンプル地図</button>
                <button id="update-map-colors" class="btn-secondary">地図更新</button>
                <button id="clear-map" class="btn-secondary" style="background: #f44336;">地図削除</button>
            </div>
            <div class="map-container">
                <div id="map-display">
                    <p>地図をアップロードするか、サンプル地図を作成してください</p>
                </div>
            </div>
            <div id="space-info-panel" class="space-info-panel">
                <div class="space-info-header">
                    <h3 id="space-info-title">スペース情報</h3>
                    <button id="close-space-info" class="btn-close">×</button>
                </div>
                <div id="space-info-content">スペースをクリックして詳細を表示</div>
            </div>
        </div>

        <!-- 編集モーダル -->
        <div id="edit-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>アイテム編集</h3>
                    <button class="btn-close" onclick="closeEditModal()">×</button>
                </div>
                <form id="edit-item-form">
                    <input type="hidden" id="edit-item-id">
                    <div class="form-group">
                        <label for="edit-space-no">スペースNo</label>
                        <input type="text" id="edit-space-no" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-item-name">商品名</label>
                        <input type="text" id="edit-item-name" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-item-price">価格</label>
                        <input type="number" id="edit-item-price" min="0">
                    </div>
                    <div class="form-group">
                        <label for="edit-item-quantity">数量</label>
                        <input type="number" id="edit-item-quantity" min="1">
                    </div>
                    <div class="form-group">
                        <label for="edit-item-notes">備考</label>
                        <textarea id="edit-item-notes" placeholder="備考を入力（任意）" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-item-image">サムネイル変更</label>
                        <input type="file" id="edit-item-image" accept="image/*">
                        <div id="edit-image-preview"></div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeEditModal()">キャンセル</button>
                        <button type="submit" class="btn-primary">保存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
</body>

</html>
